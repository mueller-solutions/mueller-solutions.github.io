---
import type { ImageMetadata } from 'astro';
import { Picture } from 'astro:assets';

type Props = astroHTML.JSX.ImgHTMLAttributes & {
  image: ImageMetadata;
  alt: string;
  preload?: boolean;
};

const { image, alt, class: className, preload = false } = Astro.props;
---

{preload && <link rel="preload" href={image.src} as="image" type="image/avif" />}
<Picture
  src={image}
  alt={alt}
  formats={['avif', 'webp']}
  widths={[400, image.width]}
  sizes={`(max-width: 480px) 400px, ${image.width}px`}
  class={className}
/>
